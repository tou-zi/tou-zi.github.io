!function(){K.Class.create("K.Page",{statics:{execute:function(t){if(cls=K.Class.get(t)){var s=new cls;return s.start(),s}throw new Error("page cls not found for "+t)}},protos:{dom:null,doms:{},hasDefaultHeader:"auto",pageType:"default",init:function(){this.dom=$("body"),this.user=new K.Model.User(window._userData),this.dom.hasClass("page-default")?(this.pageType="default",this.initDefaultHeader()):this.dom.hasClass("page-simple")&&(this.pageType="simple",this.initSimpleHeader())},initDefaultHeader:function(){},initSimpleHeader:function(){},start:function(){}}}),K.Class.create("K.Page.Index",{protos:{doms:{},start:function(){var t=this;this.dom=$("body"),this.doms.loginForm=this.dom.find(".login-form"),this.doms.accountInput=this.doms.loginForm.find(".account .rich-input-text"),this.doms.passwordInput=this.doms.loginForm.find(".password .rich-input-text"),this.doms.submitBtn=this.doms.loginForm.find(".btn-submit"),this.doms.notice=this.doms.loginForm.find(".notice>p"),this.doms.loginForm.on("submit",function(){var s=t.doms.accountInput.val(),o=t.doms.passwordInput.val();return/^1\d{10}$/.test(s)||/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(s)?o.length<4?(t.showNotice("请输入有效的密码"),!1):(_.ajax({url:"/users/login-action",data:{account:s,password:o},start:function(){t.doms.submitBtn.attr("disabled","disabled")},end:function(s){if(s.isSuccess()){t.showNotice("登录成功，正在跳转到用户主页...");var o=s.getData("cess");$.cookie("cess",o,{path:"/"}),setTimeout(function(){window.location.href="/home"},10)}else t.showNotice(s.getMessage()),t.doms.submitBtn.attr("disabled",null)}}),!1):(t.showNotice("请输入有效的手机号或邮箱"),!1)})},showNotice:function(t,s){t||(t="");var o=this;this.doms.notice.text(t).show(),s||setTimeout(function(){o.doms.notice.hide()},5e3)}}})}();